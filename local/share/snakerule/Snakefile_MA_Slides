include: 'conf.sk'

rule ggplot_themes:
	output: Rimage='theme_{size}.Rdata'
	script: SRC_DIR+'/ggthemes.R'

### Figure 1
SORTED_MR='../dataset_Figures_Tables/sorted_MR_avg.tsv'
rule figure_1b_mr:
    input: MR=REF_DATASET+"/MR_edu_SNV", theme=GGTHEME, palette=MANY_COLORS_PALETTE, order=SORTED_MR
    output: plot='fig_1b_MR.svg', avgdata="fig_1b_avg.tsv"
    log: log="fig_1b_MR.log"
    script: SRC_DIR+'/fig1b_MR.R'

rule figure_1c_dnds:
    input: dnds=REF_DATASET+"/dnds1vitro_overall.tsv", theme=GGTHEME, palette=MODELS_COLORS_PALETTE, order=SORTED_MR
    output: plot='fig_1c_dnds.svg'
    script: SRC_DIR+'/fig1c_dnds.R'

rule supplementary_edf3a_N:
    input: MR=REF_DATASET+"/vitro_gained_SNV", theme=GGTHEME, palette=MANY_COLORS_PALETTE, order=SORTED_MR
    output: plot='edf3a_N.svg', avgdata="edf3a_N_avg.tsv"
    log: log="edf3a_N.log"
    script: SRC_DIR+'/edfig3a_N.R'

rule supplementary_edf3b_nN:
    input: MR=REF_DATASET+"/MR_conte_SNV", theme=GGTHEME, palette=MANY_COLORS_PALETTE, order=SORTED_MR
    output: plot='edf3b_nN.svg', avgdata="edf3b_nN_avg.tsv"
    log: log="edf3b_nN.log"
    script: SRC_DIR+'/edf3b_nN.R'

rule Nnorm:
    input: MR=REF_DATASET+"/vitro_gained_norm_SNV", theme=GGTHEME, palette=MANY_COLORS_PALETTE, order=SORTED_MR
    output: plot='nnorm.svg', avgdata="nnorm_avg.tsv"
    log: log="Nnorm.log"
    script: SRC_DIR+'/Nnorm.R'
